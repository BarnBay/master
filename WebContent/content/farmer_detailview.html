<script src="./js/star-rating.js"></script>
<link href="./css/star-rating.css" media="all" rel="stylesheet" type="text/css"/>

<script type="text/javascript">	
	var FarmerDetailJSONObject;
	var countProducts = 0;
	
	$.ajax({
		url: "/barnbay_ui/GetFarmerByFarmerId?id=" + $.cookie("Farmer.FarmerListCategoryID")
	}).done(function(data) {
		FarmerDetailJSONObject = JSON.parse(data);		
		farmerDetailFunction(FarmerDetailJSONObject);
	});
</script>

<div class="row" id="farmerDetailInformation">
	<script type="text/javascript">
		function farmerDetailFunction(farmerDetailObject) {
			var out = "";
			
			out += '<div class="col-md-12" style="font-family: \'Roboto Condensed\', sans-serif;">';
			out += '	<div class="col-md-3">';
			out += '		<img src="./img/farmers/' + farmerDetailObject.firstname + ' ' + farmerDetailObject.lastname + '.png" alt="Image" class="img-circle center-block">';
			out += '		<h2>' + farmerDetailObject.firstname + ' ' + farmerDetailObject.lastname + '</h2>';
			/* RATING FIXEN !!!!!!!!!!!!!!!!!!!!! */
			out += '		<input id="input-21b" value="4" type="number" class="rating" min=0 max=5 step=0.2 data-size="xs">';
			out += '		<br/>';
			out += '		<div class="panel panel-success">';
			out += '			<div class="panel-heading">';
			out += '				<span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span> Address';
			out += '			</div>';
			out += '			<div class="panel-body">';
			out += '				<address>';
			out += '					' + farmerDetailObject.street + ' ' + farmerDetailObject.number + '<br/>'
			out += '					' + farmerDetailObject.zipcode + ' ' + farmerDetailObject.city + '<br/>';
			out += '					' + farmerDetailObject.email + '<br/><br/>';
			out += '					<strong>Farm opening hours:</strong><br/>' + farmerDetailObject.farmopeninghours;
			out += '				</address>';
			out += '			</div>';
			out += '		</div>';
			out += '	</div>';
			out += '	<div class="col-md-9">';			
			out += '		<div style="width: 100%; height: 270px; overflow: hidden">';
			out += '			<img src="./img/farms/' + farmerDetailObject.farmname + '.png" alt="Image" class="img-responsive center-block" width="100%" height="350">';
			out += '		</div>';
			out += '		<div id="farmerDetailImageInfo">';
			out += '			<h4>' + farmerDetailObject.farmname + '</h4>';
			out += '			<p>' + farmerDetailObject.farmdescription + '</p>';
			out += '		</div>';
			out += '		<h3>Products</h3>';
			
			for(i = 0; i < farmerDetailObject.products.length; i++) {
				if(countProducts == 0) {
					out += '		<div class="row" id="category-row-1">';
				}
				/* ID UND NAME ANPASSEN !!!!!!!!!!!!!!!!!!!!!! */
				out += '		<div class="col-md-3">';
				out += '			<div class="panel panel-default" id="FarmerSingleProduct" style="cursor: pointer" onclick="farmerSwitchToProduct(' + farmerDetailObject.idfarmer + ', ' + farmerDetailObject.products[i].catid + ')">';
				out += '				<div class="panel-body">';
				out += '					<img src="http://placehold.it/100x100" class="img-circle">';
				out += '				</div>';
				out += '				<div class="panel-footer">';
				out += '					<h3 class="panel-title">' + farmerDetailObject.products[i].name + '</h3>';
				out += '				</div>';
				out += '			</div>';
				out += '		</div>';
								
				if(countProducts < 3) {
					countProducts++;
				} else {
					out += '		</div>';
					countProducts = 0;	
				}
			}
			
			out += '		<hr>';
			out += '		<div class="panel panel-success barnbays">';
			out += '			<div class="panel-heading">';
			out += '				<span class="glyphicon glyphicon-time" aria-hidden="true"></span> BarnBay pickup Locations';
			out += '			</div>';
			out += '			<div class="panel-body">';
			out += '				<table class="table table-striped">';
			out += '					<tr>';
			out += '						<th>Name</th>';
			out += '						<th>Zip Code</th>';
			out += '						<th>Address</th>';
			out += '						<th>Pick-Up Times</th>';
			out += '					</tr>';
			
			for(i = 0; i < farmerDetailObject.barnbays.length; i++) {
				out += '					<tr>';
				out += '						<td>' + farmerDetailObject.barnbays[i].name + '</td>';
				out += '						<td>' + farmerDetailObject.barnbays[i].address.zipcode + ' ' + farmerDetailObject.barnbays[i].address.city + '</td>';
				out += '						<td>' + farmerDetailObject.barnbays[i].address.street + ' ' + farmerDetailObject.barnbays[i].address.number + '</td>';
				out += '						<td>' + farmerDetailObject.barnbays[i].opening_hours + '</td>';
				out += '					</tr>';
			}
	
			out += '				</table>';
			out += '			</div>';
			out += '		</div>';
			out += '	</div>';
			out += '</div>';
			
			/* Vielleicht noch Google Maps */
			
			document.getElementById("farmerDetailInformation").innerHTML = out;
		}
		
	</script>
</div>

<script type="text/javascript">
	function farmerSwitchToProduct(farmerid, productid) {
		$.cookie("Farmer.FarmerID", farmerid, { expires: 1 });
		$.cookie("Farmer.ProductID", productid, { expires: 1 });
	}
</script>