<script type="text/javascript">
	var JSONUserObject = JSON.parse($.cookie('User.JSON'));
	
	$.ajax({
		url: "/barnbay_ui/GetAllProductsByFarmerId?id=" + JSONUserObject.id
	}).done(function(data1) {
		displayAllFarmerProducts(JSON.parse(data1));
	});
	
	$.ajax({
		url: "/barnbay_ui/GetAllSubCategories"
	}).done(function(data2) {
		displayAllProductCategroys(JSON.parse(data2));
	});
</script>

<h2>Update actual stock!</h2>
<table id="stockProductTable" class="table table-hover">

</table>

<h2>Add new Products to your stock!</h2>

<table id="stockAddProductTable" class="table table-hover">

</table>

<!-- Update Table: stockProductTable -->
<script type="text/javascript">
	function displayAllFarmerProducts(farmerProducts) {
		var out = "";
		
		out += '		<thead>';
		out += '			<tr>';
		out += '				<th class="col-md-1 text-center">#</th>';
		out += '				<th class="col-md-2 text-center">Productname</th>';
		out += '				<th class="col-md-1 text-center">Quantity</th>';
		out += '				<th class="col-md-2 text-center">Update Quantity</th>';
		out += '				<th class="col-md-1 text-center">Price</th>';
		out += '				<th class="col-md-2 text-center">Update Price</th>';
		out += '				<th class="col-md-3 text-center">Description</th>';
		out += '			</tr>';
		out += '		</thead>';
		out += '		<tbody id="stockUpdateTable">';
		
		for(i = 0; i < farmerProducts.length; i++) {
			p = i + 1;
			
			out += '			<tr>';
			out += '				<td style="vertical-align: middle;">' + p + '</td>';
			out += '				<td style="vertical-align: middle;">' + farmerProducts[i].name + '</td>';
			out += '				<td style="vertical-align: middle;">' + farmerProducts[i].stock + '</td>';
			out += '				<td style="vertical-align: middle;"><input type="number" class="form-control farmerProductStock" maxlength="4" value="' + farmerProducts[i].stock + '"></td>';
			out += '				<td style="vertical-align: middle;">' + (farmerProducts[i].price).toFixed(2) + ' &euro;</td>';
			out += '				<td style="vertical-align: middle;"><input type="number" class="form-control farmerProductPrice" value="' + (farmerProducts[i].price).toFixed(2) + '"></td>';
			out += '				<td style="vertical-align: middle;"><textarea class="form-control farmerProductDescription" rows="2">' + farmerProducts[i].description + '</textarea></td>';
			out += '			</tr>';
		}
		
		out += '			<tr>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td>';
		out += '					<button type="button" id="updateFarmerProduct" class="btn btn-block btn-success">';
		out += '						<span class="glyphicon glyphicon-saved"></span> Update stock';
		out += '					</button>';
		out += '				</td>';
		out += '			</tr>';
		out += '		</tbody>';
		
		document.getElementById("stockProductTable").innerHTML = out;
	}
</script>

<!-- Update Table: stockProductTable -->
<script type="text/javascript">
	function displayAllProductCategroys(ProductCategories) {
		var out = "";
		
		out += '		<thead>';
		out += '			<tr>';
		out += '				<th class="col-md-3 text-center">Productname</th>';
		out += '				<th class="col-md-2 text-center">Quantity</th>';
		out += '				<th class="col-md-2 text-center">Price in Euro</th>';
		out += '				<th class="col-md-5 text-center">Description</th>';
		out += '			</tr>';
		out += '		</thead>';
		out += '		<tbody>';
		out += '			<tr>';
		out += '				<td style="vertical-align: middle; class="col-md-2">';
		out += '					<select class="form-control input-md">';
		
		for(i = 0; i < ProductCategories.length; i++) {
			out += '						<option value="' + ProductCategories[i].idcategory + '">' + ProductCategories[i].name + '</option>';	
		}
		
		out += '					</select>';
		out += '				</td>';
		out += '				<td style="vertical-align: middle;><input></td>';
		out += '				<td style="vertical-align: middle;><input></td>';
		out += '				<td style="vertical-align: middle;><textarea class="form-control" rows="3"></textarea></td>';
		out += '			</tr>';
		out += '			<tr>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td></td>';
		out += '				<td align="right">';
		out += '					<button type="button" class="btn btn-success">';
		out += '						<span class="glyphicon glyphicon-saved"></span> Add Product';
		out += '					</button>';
		out += '				</td>';
		out += '			</tr>';
		out += '		</tbody>';
		
		
		document.getElementById("stockAddProductTable").innerHTML = out;
	}
</script>

<!-- Check if update Button was clicked -->
<script type="text/javascript">
	$('#mainContainer').on('click', '#updateFarmerProduct', function(e) {
		e.preventDefault();
		
		$('#stockUpdateTable').find('.farmerProductPrice').each(function() {
			//alert(this.value);
		});
	});
</script>