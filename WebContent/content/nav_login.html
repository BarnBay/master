<li id="mainLogin" class="dropdown">
	<a href="" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-log-in"></span> Login <span class="caret"></span></a>
	<div class="dropdown-menu">		
		<form id="navLoginForm" class="form col-md-12 center-block" accept-charset="utf-8" role="form">
			<p>
				<input type="text" name="email" id="navLoginEmail" value="" class="form-control input-md" placeholder="Email Address" required />
			</p>
			
			<p>
				<input type="password" name="password" id="navLoginPassword" value="" class="form-control input-md" placeholder="Password" required />
			</p>
			
			<button class="btn btn-md btn-success btn-block signup-btn" type="submit">SignIn</button>
			
			<span class="pull-right">
				<button id="registerForm" type="button" class="btn btn-link">Register</button>
			</span>
			
			<span>
				<button type="button" id="helpForm" class="btn btn-link">Need help?</button>
			</span>
     	</form>
	</div>
</li>

<script type="text/javascript">
	$("#navLoginForm").submit(function(event) {
		event.preventDefault();
		$.ajax({
			type: "POST",
			url: "/barnbay_ui/Login",
			dataType : "json",
			data: JSON.stringify({"passwordhash":$('#navLoginPassword').val(), "username":$('#navLoginEmail').val()}),
			success:function(data) {
				if(data.login == "success") {
					$('#mainNavbarRight').load('./content/nav_account.html');
					$.cookie('User.Username', data.user.username, { expires: 1 });
					$.cookie('User.Session', data.user.session, { expires: 1 });
					$.cookie('User.Usertype', data.user.usertype, { expires: 1 });
					$.cookie('User.JSON', JSON.stringify(data.user), { expires: 1 });
					$.cookie('Products.ShoppingCart', '{"shoppingcart":[]}', { expires: 1 });
				} else {
					$('#navLoginModalFailed').modal('show'); 
				}
			}
		});
	});
</script>

<div class="modal fade" id="navLoginModalFailed" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
  			<div class="modal-header">
    			<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
    			<h4 class="modal-title" id="myModalLabel">Error</h4>
  			</div>
  			<div class="modal-body">
    			Login failed, please try again
  			</div>
  			<div class="modal-footer">
    			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
  			</div>
		</div>
	</div>
</div>
